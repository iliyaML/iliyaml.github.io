<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" as="font" href="/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="/fonts/vendor/jost/jost-v4-latin-500.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin>

  <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>

  <link rel="stylesheet" href="/main.92c80ad23243dd5f2400ab0e9e794051477a29162f47306f46ef2df68041d3633a166efd0bc34ba34b3d54760fa94692193970019875b1278527741daaf0bb0c.css" integrity="sha512-ksgK0jJD3V8kAKsOnnlAUUd6KRYvRzBvRu8t9oBB02M6Fm79C8NLo0s9VHYPqUaSGTlwAZh1sSeFJ3QdqvC7DA==" crossorigin="anonymous">
<noscript><style>img.lazyload { display: none; }</style></noscript>
  <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <title>Week 2 Part 2 - Parameter Efficient Fine-Tuning | iliyaML</title>
<meta name="description" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">
<link rel="canonical" href="/notes/nlp/generative-ai-with-llms/week-2-part-2/">
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">
<meta property="og:description" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">
<meta property="og:url" content="/notes/nlp/generative-ai-with-llms/week-2-part-2/">
<meta property="og:site_name" content="iliyaML">
<meta property="article:published_time" content="2023-05-23T13:59:39+01:00">
  <meta property="article:modified_time" content="2023-05-23T13:59:39+01:00">
  
  
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="">
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">
<meta name="twitter:description" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">
<meta name="twitter:card" content="summary">
    <meta name="twitter:image:alt" content="Week 2 Part 2 - Parameter Efficient Fine-Tuning">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
        "@id": "/#/schema/person/1",
      "name": "",
      "url": "/",
      "sameAs": [
        ],
      "image": {
          "@type": "ImageObject",
          "@id": "/#/schema/image/1",
          "url": "/\u003cnil\u003e",
          "width":  null ,
          "height":  null ,
          "caption": ""
        }
      },
    {
      "@type": "WebSite",
      "@id": "/#/schema/website/1",
      "url": "/",
      "name": "iliyaML",
      "description": "Hi, Iâ€™m Iliya ðŸ‘‹",
      "publisher": {
          "@id": "/#/schema/person/1"
        }
      },
    {
      "@type": "WebPage",
      "@id": "/notes/nlp/generative-ai-with-llms/week-2-part-2/",
      "url": "/notes/nlp/generative-ai-with-llms/week-2-part-2/",
      "name": "Week 2 Part 2 - Parameter Efficient Fine-Tuning",
      "description": "Week 2 Part 2 - Parameter Efficient Fine-Tuning",
      "isPartOf": {
        "@id": "/#/schema/website/1"
      },
      "about": {
          "@id": "/#/schema/person/1"
        },
      "datePublished": "2023-05-23T13:59:39CET",
      "dateModified": "2023-05-23T13:59:39CET",
      "breadcrumb": {
        "@id": "/notes/nlp/generative-ai-with-llms/week-2-part-2/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "/notes/nlp/generative-ai-with-llms/week-2-part-2/#/schema/image/2"
      },
      "inLanguage": "",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["/notes/nlp/generative-ai-with-llms/week-2-part-2/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "/notes/nlp/generative-ai-with-llms/week-2-part-2/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "/",
          "url": "/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@id": "/notesnlpgenerative-ai-with-llmsweek-2-part-2/"
          }
        }]
    },

    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "/notes/nlp/generative-ai-with-llms/week-2-part-2/#/schema/image/2",
          "url":  null ,
          "contentUrl":  null ,
          "caption": "Week 2 Part 2 - Parameter Efficient Fine-Tuning"
        }
      ]
    }

  ]
}
</script>

  <meta name="theme-color" content="#fff">
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" crossorigin="use-credentials" href="/site.webmanifest">

  

</head>

  <body class="notes single">
    <div class="sticky-top">
<div class="header-bar"></div>

<header class="navbar navbar-expand-lg navbar-light doks-navbar">
  <nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation">

    <a class="navbar-brand order-0" href="/" aria-label="iliyaML">
      iliyaML
    </a>

    <button class="btn btn-link order-0 ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
    </button>
    <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
      <div class="header-bar"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">Browse notes</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <aside class="doks-sidebar mt-n3">
          <nav id="doks-docs-nav" aria-label="Tertiary navigation">
            
<ul class="list-unstyled collapsible-sidebar">
  
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-091fa9121c047db1dd48c3e2ab5f3c91" aria-expanded="false">
          Machine Learning
        </button>
        <div class="collapse" id="section-091fa9121c047db1dd48c3e2ab5f3c91">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/k-nearest-neighbors/">K-Nearest Neighbors (KNN)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/linear-regression/">Linear Regression</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/logistic-regression/">Logistic Regression</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-6a68b6412b3d8a605c374d3c59e02694" aria-expanded="false">
          Deep Learning
        </button>
        <div class="collapse" id="section-6a68b6412b3d8a605c374d3c59e02694">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/deep-learning/neural-networks/">Neural Networks</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-85587c49afa2ea2adacd4bbcdb57d064" aria-expanded="true">
          NLP
        </button>
        <div class="collapse show" id="section-85587c49afa2ea2adacd4bbcdb57d064">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/papers/">Papers</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/attention-is-all-you-need/">Attention is All You Need (2017)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/state-of-gpt-2023/">State of GPT (2023)</a></li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-2828d5a2b445bfbe4d992368391c42e2" aria-expanded="true">
                    Generative AI with Large Language Models
                  </button>
                  <div class="collapse show" id="section-2828d5a2b445bfbe4d992368391c42e2">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-1/">Week 1 Part 1 - Introduction to LLMs and the Generative AI Project Lifecycle</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/transformers-architecture/">Week 1 Part 1 - Transformers Architecture</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-2/">Week 1 Part 2 - Pre-training and Scaling Laws</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-2-part-1/">Week 2 Part 1 - Fine-tuning LLMs with Instruction</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded active" href="/notes/nlp/generative-ai-with-llms/week-2-part-2/">Week 2 Part 2 - Parameter Efficient Fine-Tuning</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-c33e404a441c6ba9648f88af3c68a1ca" aria-expanded="false">
          Statistics
        </button>
        <div class="collapse" id="section-c33e404a441c6ba9648f88af3c68a1ca">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/statistics/introduction/">Introduction</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-89320dbd4e0a792bc1676fde2d5bccfc" aria-expanded="false">
          DSA
        </button>
        <div class="collapse" id="section-89320dbd4e0a792bc1676fde2d5bccfc">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/dsa/data-structures-and-algorithms/">Data Structures &amp; Algorithms</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-98bf5c1a28c1981bf8d74d4bc73ceaab" aria-expanded="false">
          System Design
        </button>
        <div class="collapse" id="section-98bf5c1a28c1981bf8d74d4bc73ceaab">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-0460583622f03a52d7693094d6fa2452" aria-expanded="false">
                    Concepts
                  </button>
                  <div class="collapse" id="section-0460583622f03a52d7693094d6fa2452">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/basics/">Basics</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/20-concepts/">20 Concepts</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/25-golden-rules/">25 Golden Rules</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/key-steps/">Key Steps</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-1afa74da05ca145d3418aad9af510109" aria-expanded="false">
                    Design
                  </button>
                  <div class="collapse" id="section-1afa74da05ca145d3418aad9af510109">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/url-shortener/">URL Shortener</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/short-media-sharing-platform/">Short Media Sharing Platform</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/video-streaming-platform/">Video Streaming Platform</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
  
</ul>

          </nav>
        </aside>
      </div>
    </div>
    <button class="btn btn-menu order-2 d-block d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
    <div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel">
      <div class="header-bar d-lg-none"></div>
      <div class="offcanvas-header d-lg-none">
        <h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/">iliyaML</a></h2>
        <button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button>
      </div>
      <div class="offcanvas-body p-4 p-lg-0">
        <ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/about/">About</a>
              </li>
            
          
              <li class="nav-item">
                <a class="nav-link ps-0 py-1 active" href="/notes/machine-learning/k-nearest-neighbors">Notes</a>
              </li>
            
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2">
          <input id="search" class="form-control is-search" type="search" placeholder="Search..." aria-label="Search..." autocomplete="off">
          <div id="suggestions" class="shadow bg-white rounded d-none"></div>
        </form>
        <hr class="text-black-50 my-4 d-lg-none">
        <ul class="nav flex-column flex-lg-row">
          <li class="nav-item">
              <a class="nav-link social-link" href="https://github.com/iliyaML"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><small class="ms-2 d-lg-none">GitHub</small></a>
            </li>
          <li class="nav-item">
              <a class="nav-link social-link" href="https://www.linkedin.com/in/iliya-mohamad-lokman"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg><small class="ms-2 d-lg-none">LinkedIn</small></a>
            </li>
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <button id="mode" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
          <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
          <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
        </button>
        </div>
    </div>
  </nav>
</header>


</div>


<div class="container-xxl">
  <aside class="doks-sidebar">
    <nav id="doks-docs-nav" class="collapse d-lg-none" aria-label="Tertiary navigation">
      
<ul class="list-unstyled collapsible-sidebar">
  
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-091fa9121c047db1dd48c3e2ab5f3c91" aria-expanded="false">
          Machine Learning
        </button>
        <div class="collapse" id="section-091fa9121c047db1dd48c3e2ab5f3c91">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/k-nearest-neighbors/">K-Nearest Neighbors (KNN)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/linear-regression/">Linear Regression</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/logistic-regression/">Logistic Regression</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-6a68b6412b3d8a605c374d3c59e02694" aria-expanded="false">
          Deep Learning
        </button>
        <div class="collapse" id="section-6a68b6412b3d8a605c374d3c59e02694">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/deep-learning/neural-networks/">Neural Networks</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-85587c49afa2ea2adacd4bbcdb57d064" aria-expanded="true">
          NLP
        </button>
        <div class="collapse show" id="section-85587c49afa2ea2adacd4bbcdb57d064">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/papers/">Papers</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/attention-is-all-you-need/">Attention is All You Need (2017)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/state-of-gpt-2023/">State of GPT (2023)</a></li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-2828d5a2b445bfbe4d992368391c42e2" aria-expanded="true">
                    Generative AI with Large Language Models
                  </button>
                  <div class="collapse show" id="section-2828d5a2b445bfbe4d992368391c42e2">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-1/">Week 1 Part 1 - Introduction to LLMs and the Generative AI Project Lifecycle</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/transformers-architecture/">Week 1 Part 1 - Transformers Architecture</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-2/">Week 1 Part 2 - Pre-training and Scaling Laws</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-2-part-1/">Week 2 Part 1 - Fine-tuning LLMs with Instruction</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded active" href="/notes/nlp/generative-ai-with-llms/week-2-part-2/">Week 2 Part 2 - Parameter Efficient Fine-Tuning</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-c33e404a441c6ba9648f88af3c68a1ca" aria-expanded="false">
          Statistics
        </button>
        <div class="collapse" id="section-c33e404a441c6ba9648f88af3c68a1ca">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/statistics/introduction/">Introduction</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-89320dbd4e0a792bc1676fde2d5bccfc" aria-expanded="false">
          DSA
        </button>
        <div class="collapse" id="section-89320dbd4e0a792bc1676fde2d5bccfc">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/dsa/data-structures-and-algorithms/">Data Structures &amp; Algorithms</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-98bf5c1a28c1981bf8d74d4bc73ceaab" aria-expanded="false">
          System Design
        </button>
        <div class="collapse" id="section-98bf5c1a28c1981bf8d74d4bc73ceaab">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-0460583622f03a52d7693094d6fa2452" aria-expanded="false">
                    Concepts
                  </button>
                  <div class="collapse" id="section-0460583622f03a52d7693094d6fa2452">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/basics/">Basics</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/20-concepts/">20 Concepts</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/25-golden-rules/">25 Golden Rules</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/key-steps/">Key Steps</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-1afa74da05ca145d3418aad9af510109" aria-expanded="false">
                    Design
                  </button>
                  <div class="collapse" id="section-1afa74da05ca145d3418aad9af510109">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/url-shortener/">URL Shortener</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/short-media-sharing-platform/">Short Media Sharing Platform</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/video-streaming-platform/">Video Streaming Platform</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
  
</ul>

    </nav>
  </aside>
</div>

    <div class="wrap container-xxl" role="document">
      <div class="content">
        
	<div class="row flex-xl-nowrap">
		<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
			<nav class="docs-links" aria-label="Main navigation">
				
<ul class="list-unstyled collapsible-sidebar">
  
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-091fa9121c047db1dd48c3e2ab5f3c91" aria-expanded="false">
          Machine Learning
        </button>
        <div class="collapse" id="section-091fa9121c047db1dd48c3e2ab5f3c91">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/k-nearest-neighbors/">K-Nearest Neighbors (KNN)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/linear-regression/">Linear Regression</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/machine-learning/logistic-regression/">Logistic Regression</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-6a68b6412b3d8a605c374d3c59e02694" aria-expanded="false">
          Deep Learning
        </button>
        <div class="collapse" id="section-6a68b6412b3d8a605c374d3c59e02694">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/deep-learning/neural-networks/">Neural Networks</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-85587c49afa2ea2adacd4bbcdb57d064" aria-expanded="true">
          NLP
        </button>
        <div class="collapse show" id="section-85587c49afa2ea2adacd4bbcdb57d064">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/papers/">Papers</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/attention-is-all-you-need/">Attention is All You Need (2017)</a></li>
              
            
              
                
                <li><a class="docs-link rounded" href="/notes/nlp/state-of-gpt-2023/">State of GPT (2023)</a></li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-2828d5a2b445bfbe4d992368391c42e2" aria-expanded="true">
                    Generative AI with Large Language Models
                  </button>
                  <div class="collapse show" id="section-2828d5a2b445bfbe4d992368391c42e2">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-1/">Week 1 Part 1 - Introduction to LLMs and the Generative AI Project Lifecycle</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/transformers-architecture/">Week 1 Part 1 - Transformers Architecture</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-1-part-2/">Week 1 Part 2 - Pre-training and Scaling Laws</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/nlp/generative-ai-with-llms/week-2-part-1/">Week 2 Part 1 - Fine-tuning LLMs with Instruction</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded active" href="/notes/nlp/generative-ai-with-llms/week-2-part-2/">Week 2 Part 2 - Parameter Efficient Fine-Tuning</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-c33e404a441c6ba9648f88af3c68a1ca" aria-expanded="false">
          Statistics
        </button>
        <div class="collapse" id="section-c33e404a441c6ba9648f88af3c68a1ca">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/statistics/introduction/">Introduction</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-89320dbd4e0a792bc1676fde2d5bccfc" aria-expanded="false">
          DSA
        </button>
        <div class="collapse" id="section-89320dbd4e0a792bc1676fde2d5bccfc">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li><a class="docs-link rounded" href="/notes/dsa/data-structures-and-algorithms/">Data Structures &amp; Algorithms</a></li>
              
            
          </ul>
        </div>
      </li>
    
      
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-98bf5c1a28c1981bf8d74d4bc73ceaab" aria-expanded="false">
          System Design
        </button>
        <div class="collapse" id="section-98bf5c1a28c1981bf8d74d4bc73ceaab">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-0460583622f03a52d7693094d6fa2452" aria-expanded="false">
                    Concepts
                  </button>
                  <div class="collapse" id="section-0460583622f03a52d7693094d6fa2452">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/basics/">Basics</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/20-concepts/">20 Concepts</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/25-golden-rules/">25 Golden Rules</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/concepts/key-steps/">Key Steps</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
              
                
                <li class="my-1 ms-3">
                  <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#section-1afa74da05ca145d3418aad9af510109" aria-expanded="false">
                    Design
                  </button>
                  <div class="collapse" id="section-1afa74da05ca145d3418aad9af510109">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/url-shortener/">URL Shortener</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/short-media-sharing-platform/">Short Media Sharing Platform</a></li>
                        
                      
                        
                          
                          <li><a class="docs-link rounded" href="/notes/system-design/design/video-streaming-platform/">Video Streaming Platform</a></li>
                        
                      
                    </ul>
                  </div>
                </li>
              
            
          </ul>
        </div>
      </li>
    
  
</ul>

			</nav>
		</div>
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>On this page</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#notes">Notes</a></li>
    <li><a href="#parameter-efficient-fine-tuning">Parameter Efficient Fine-Tuning</a>
      <ul>
        <li><a href="#full-fine-tuning-creates-full-copy-of-original-llm-per-task">Full Fine-tuning Creates Full Copy of Original LLM Per Task</a></li>
        <li><a href="#peft-saves-space-and-is-flexible">PEFT Saves Space and is Flexible</a></li>
        <li><a href="#peft-trade-offs">PEFT Trade-offs</a></li>
        <li><a href="#peft-methods">PEFT Methods</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-1-lora">PEFT Techniques 1: LoRA</a>
      <ul>
        <li><a href="#transformers-recap">Transformers Recap</a></li>
        <li><a href="#lora">LoRA</a></li>
        <li><a href="#lora-example">LoRA Example</a></li>
        <li><a href="#train-on-different-tasks">Train on Different Tasks</a></li>
        <li><a href="#performance-of-lora">Performance of LoRA</a></li>
        <li><a href="#choosing-the-lora-rank">Choosing the LoRA Rank</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-2-soft-prompts">PEFT Techniques 2: Soft Prompts</a>
      <ul>
        <li><a href="#prompt-tuning-is-not-prompt-engineering">Prompt Tuning is Not Prompt Engineering</a></li>
        <li><a href="#prompt-tuning">Prompt Tuning</a></li>
        <li><a href="#soft-prompts">Soft Prompts</a></li>
        <li><a href="#full-fine-tuning-vs-prompt-tuning">Full Fine-tuning vs Prompt Tuning</a></li>
        <li><a href="#prompt-tuning-for-multiple-tasks">Prompt Tuning for Multiple Tasks</a></li>
        <li><a href="#performance-of-prompt-tuning">Performance of Prompt Tuning</a></li>
        <li><a href="#interpretability-of-soft-prompts">Interpretability of Soft Prompts</a></li>
        <li><a href="#summary-peft-methods">Summary: PEFT Methods</a></li>
        <li><a href="#key-takeaways">Key Takeaways</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>On this page</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#notes">Notes</a></li>
    <li><a href="#parameter-efficient-fine-tuning">Parameter Efficient Fine-Tuning</a>
      <ul>
        <li><a href="#full-fine-tuning-creates-full-copy-of-original-llm-per-task">Full Fine-tuning Creates Full Copy of Original LLM Per Task</a></li>
        <li><a href="#peft-saves-space-and-is-flexible">PEFT Saves Space and is Flexible</a></li>
        <li><a href="#peft-trade-offs">PEFT Trade-offs</a></li>
        <li><a href="#peft-methods">PEFT Methods</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-1-lora">PEFT Techniques 1: LoRA</a>
      <ul>
        <li><a href="#transformers-recap">Transformers Recap</a></li>
        <li><a href="#lora">LoRA</a></li>
        <li><a href="#lora-example">LoRA Example</a></li>
        <li><a href="#train-on-different-tasks">Train on Different Tasks</a></li>
        <li><a href="#performance-of-lora">Performance of LoRA</a></li>
        <li><a href="#choosing-the-lora-rank">Choosing the LoRA Rank</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-2-soft-prompts">PEFT Techniques 2: Soft Prompts</a>
      <ul>
        <li><a href="#prompt-tuning-is-not-prompt-engineering">Prompt Tuning is Not Prompt Engineering</a></li>
        <li><a href="#prompt-tuning">Prompt Tuning</a></li>
        <li><a href="#soft-prompts">Soft Prompts</a></li>
        <li><a href="#full-fine-tuning-vs-prompt-tuning">Full Fine-tuning vs Prompt Tuning</a></li>
        <li><a href="#prompt-tuning-for-multiple-tasks">Prompt Tuning for Multiple Tasks</a></li>
        <li><a href="#performance-of-prompt-tuning">Performance of Prompt Tuning</a></li>
        <li><a href="#interpretability-of-soft-prompts">Interpretability of Soft Prompts</a></li>
        <li><a href="#summary-peft-methods">Summary: PEFT Methods</a></li>
        <li><a href="#key-takeaways">Key Takeaways</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
			<h1>Week 2 Part 2 - Parameter Efficient Fine-Tuning</h1>
			<p class="lead"></p>
			<nav class="d-xl-none" aria-label="Quaternary navigation">
				<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>On this page</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#notes">Notes</a></li>
    <li><a href="#parameter-efficient-fine-tuning">Parameter Efficient Fine-Tuning</a>
      <ul>
        <li><a href="#full-fine-tuning-creates-full-copy-of-original-llm-per-task">Full Fine-tuning Creates Full Copy of Original LLM Per Task</a></li>
        <li><a href="#peft-saves-space-and-is-flexible">PEFT Saves Space and is Flexible</a></li>
        <li><a href="#peft-trade-offs">PEFT Trade-offs</a></li>
        <li><a href="#peft-methods">PEFT Methods</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-1-lora">PEFT Techniques 1: LoRA</a>
      <ul>
        <li><a href="#transformers-recap">Transformers Recap</a></li>
        <li><a href="#lora">LoRA</a></li>
        <li><a href="#lora-example">LoRA Example</a></li>
        <li><a href="#train-on-different-tasks">Train on Different Tasks</a></li>
        <li><a href="#performance-of-lora">Performance of LoRA</a></li>
        <li><a href="#choosing-the-lora-rank">Choosing the LoRA Rank</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-2-soft-prompts">PEFT Techniques 2: Soft Prompts</a>
      <ul>
        <li><a href="#prompt-tuning-is-not-prompt-engineering">Prompt Tuning is Not Prompt Engineering</a></li>
        <li><a href="#prompt-tuning">Prompt Tuning</a></li>
        <li><a href="#soft-prompts">Soft Prompts</a></li>
        <li><a href="#full-fine-tuning-vs-prompt-tuning">Full Fine-tuning vs Prompt Tuning</a></li>
        <li><a href="#prompt-tuning-for-multiple-tasks">Prompt Tuning for Multiple Tasks</a></li>
        <li><a href="#performance-of-prompt-tuning">Performance of Prompt Tuning</a></li>
        <li><a href="#interpretability-of-soft-prompts">Interpretability of Soft Prompts</a></li>
        <li><a href="#summary-peft-methods">Summary: PEFT Methods</a></li>
        <li><a href="#key-takeaways">Key Takeaways</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>On this page</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#notes">Notes</a></li>
    <li><a href="#parameter-efficient-fine-tuning">Parameter Efficient Fine-Tuning</a>
      <ul>
        <li><a href="#full-fine-tuning-creates-full-copy-of-original-llm-per-task">Full Fine-tuning Creates Full Copy of Original LLM Per Task</a></li>
        <li><a href="#peft-saves-space-and-is-flexible">PEFT Saves Space and is Flexible</a></li>
        <li><a href="#peft-trade-offs">PEFT Trade-offs</a></li>
        <li><a href="#peft-methods">PEFT Methods</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-1-lora">PEFT Techniques 1: LoRA</a>
      <ul>
        <li><a href="#transformers-recap">Transformers Recap</a></li>
        <li><a href="#lora">LoRA</a></li>
        <li><a href="#lora-example">LoRA Example</a></li>
        <li><a href="#train-on-different-tasks">Train on Different Tasks</a></li>
        <li><a href="#performance-of-lora">Performance of LoRA</a></li>
        <li><a href="#choosing-the-lora-rank">Choosing the LoRA Rank</a></li>
      </ul>
    </li>
    <li><a href="#peft-techniques-2-soft-prompts">PEFT Techniques 2: Soft Prompts</a>
      <ul>
        <li><a href="#prompt-tuning-is-not-prompt-engineering">Prompt Tuning is Not Prompt Engineering</a></li>
        <li><a href="#prompt-tuning">Prompt Tuning</a></li>
        <li><a href="#soft-prompts">Soft Prompts</a></li>
        <li><a href="#full-fine-tuning-vs-prompt-tuning">Full Fine-tuning vs Prompt Tuning</a></li>
        <li><a href="#prompt-tuning-for-multiple-tasks">Prompt Tuning for Multiple Tasks</a></li>
        <li><a href="#performance-of-prompt-tuning">Performance of Prompt Tuning</a></li>
        <li><a href="#interpretability-of-soft-prompts">Interpretability of Soft Prompts</a></li>
        <li><a href="#summary-peft-methods">Summary: PEFT Methods</a></li>
        <li><a href="#key-takeaways">Key Takeaways</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>

			</nav>
			<h2 id="notes">Notes <a href="#notes" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>Full Fine-tuning - every model weight is updated during supervised learning
<ul>
<li>Requires memory not just to store the model, but various other parameters that are required during the training process
<ul>
<li>Weights</li>
<li>Optimizer States</li>
<li>Gradients</li>
<li>Forward Activations</li>
<li>Temporary Memory used</li>
</ul>
</li>
<li>Can lead to Catastrophic Forgetting</li>
<li>Results in a new version of the model for every task you train on, thus can create an expensive storage problem if youâ€™re fine-tuning for multiple tasks</li>
</ul>
</li>
<li>Parameter Efficient Fine-tuning (PEFT) - only update a small subset of the model parameters
<ul>
<li>Freezes most (if not all) of the original model weights and focus on fine-tuning a subset of (existing or additional) model parameters
<ul>
<li>The number of trained parameters is much smaller than the number of parameters in the original LLM
<ul>
<li>In some cases, just 15-20% of the original LLM weights</li>
</ul>
</li>
</ul>
</li>
<li>More robust against Catastrophic Forgetting</li>
<li>PEFT Saves Space and is Flexible
<ul>
<li>Train only a small number of weights, which results in a much smaller footprint overall (MB, GB)</li>
<li>New parameters are combined with the original LLM weights for inference</li>
<li>The PEFT weights are trained for each task and can be easily swapped out for inference, allowing efficient adaptation of the original model to multiple tasks</li>
</ul>
</li>
<li>PEFT Trade-offs
<ul>
<li>Parameter Efficiency</li>
<li>Training Speed</li>
<li>Inference Costs</li>
<li>Model Performance</li>
<li>Memory Efficiency</li>
</ul>
</li>
<li>Three Main Classes of PEFT Methods
<ol>
<li>Selective - fine-tune only a subset of the original LLM parameters</li>
<li>Reparameterization - work with the original LLM parameters, but reduce the number of parameters to train by creating new low rank transformations of the original network weights
<ol>
<li>LoRA</li>
</ol>
</li>
<li>Additive - keep all of the LLM weights frozen and introduce new trainable components
<ol>
<li>Adapters</li>
<li>Soft Prompts - Prompt Tuning</li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
<li>PEFT Techniques 1: LoRA (Low Rank Adaptation of LLMs) - a strategy that reduces the number of parameters to be trained during fine-tuning by freezing all of the original model parameters and then injecting a pair of rank decomposition matrices alongside the original weights
<ul>
<li>Training
<ol>
<li>Freeze most of the original LLM weights</li>
<li>Inject 2 Rank Decomposition Matrices (Rank r is small simension, typically 4, 8, â€¦,  64)</li>
<li>Train the weights of the smaller matrices</li>
</ol>
</li>
<li>Inference
<ul>
<li>Matrix multiple the low rank matrices</li>
<li>Add to original weights</li>
</ul>
</li>
<li>Latency - little to no impact as the model has the same number of parameters as the original</li>
<li>Apply LoRA to the Self-Attention layers since most of the parameters of LLMs are in these layers
<ul>
<li>Though it can also be applied to other layers as well like FFN layers</li>
</ul>
</li>
<li>Can often perform LoRA with a single GPU and avoid the need for a distributed cluster of GPUs</li>
<li>Train on Different Tasks
<ol>
<li>Train different rank decomposition matrices for different tasks</li>
<li>Update weights before inference</li>
</ol>
</li>
<li>The memory required to store these LoRA matrices is very small, therefore can use LoRA to train for many tasks</li>
<li>Choosing the LoRA Rank (r)
<ul>
<li>The smaller the rank, the smaller the number of trainable parameters, the bigger the savings on compute</li>
<li>Ranks in the range of 4-32 can provide you with a good trade-off between reducing trainable parameters and preserving performance</li>
</ul>
</li>
<li>Can combine with Quantization techniques to further reduce memory footprint: QLoRA</li>
</ul>
</li>
<li>PEFT Techniques 2: Soft Prompts
<ul>
<li>Trainable tokens are added to the prompt and the model weights are left frozen</li>
</ul>
</li>
<li>Lab 2 - Fine-tune a Generative AI Model For Dialogue Summarization
<ul>
<li>Model: flan-t5-base</li>
<li>Task: Dialogue Summarization</li>
<li>Metrics: ROUGE</li>
<li>Comparison of model performance
<ul>
<li>Original model</li>
<li>Fully Fine-tuned model</li>
<li>PEFT model</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="parameter-efficient-fine-tuning">Parameter Efficient Fine-Tuning <a href="#parameter-efficient-fine-tuning" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>Training LLMs is computationally intensive</li>
<li>Full fine-tuning requires memory not just to store the model, but various other parameters that are required during the training process.
<ul>
<li>Even if your computer can hold the model weights, which are now on the order of hundreds of gigabytes for the largest models, you must also be able to allocate memory for optimizer states, gradients, forward activations, and temporary memory throughout the training process.</li>
<li>These additional components can be many times larger than the model and can quickly become too large to handle on consumer hardware</li>
</ul>
</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled.png" alt="Untitled"></p>
<ul>
<li>In contrast to full fine-tuning where every model weight is updated during supervised learning, <strong>Parameter Efficient Fine-tuning (PEFT)</strong> methods only update a small subset of parameters.</li>
<li>Some path techniques freeze most of the model weights and focus on fine-tuning a subset of existing model parameters, for example, particular layers or components</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%201.png" alt="Untitled"></p>
<ul>
<li>Other techniques don&rsquo;t touch the original model weights at all, and instead add a small number of new parameters or layers and fine-tune only the new components.</li>
<li>With PEFT, most if not all of the LLM weights are kept frozen.</li>
<li>As a result, the number of trained parameters is much smaller than the number of parameters in the original LLM.
<ul>
<li>In some cases, just 15-20% of the original LLM weights.</li>
</ul>
</li>
<li>This makes the memory requirements for training much more manageable. In fact, PEFT can often be performed on a single GPU.</li>
<li>And because the original LLM is only slightly modified or left unchanged, PEFT is less prone to the <strong>Catastrophic Forgetting</strong> problems of full fine-tuning</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%202.png" alt="Untitled"></p>
<h3 id="full-fine-tuning-creates-full-copy-of-original-llm-per-task">Full Fine-tuning Creates Full Copy of Original LLM Per Task <a href="#full-fine-tuning-creates-full-copy-of-original-llm-per-task" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Full fine-tuning results in a new version of the model for every task you train on.</li>
<li>Each of these is the same size as the original model, so it can create an expensive storage problem if you&rsquo;re fine-tuning for multiple tasks</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%203.png" alt="Untitled"></p>
<h3 id="peft-saves-space-and-is-flexible">PEFT Saves Space and is Flexible <a href="#peft-saves-space-and-is-flexible" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>With parameter efficient fine-tuning, you train only a small number of weights, which results in a much smaller footprint overall, as small as megabytes depending on the task.</li>
<li>The new parameters are combined with the original LLM weights for inference.</li>
<li>The PEFT weights are trained for each task and can be easily swapped out for inference, allowing efficient adaptation of the original model to multiple tasks</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%204.png" alt="Untitled"></p>
<h3 id="peft-trade-offs">PEFT Trade-offs <a href="#peft-trade-offs" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>There are several methods you can use for parameter efficient fine-tuning, each with trade-offs on parameter efficiency, memory efficiency, training speed, model quality, and inference costs</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%205.png" alt="Untitled"></p>
<h3 id="peft-methods">PEFT Methods <a href="#peft-methods" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Let&rsquo;s take a look at the three main classes of PEFT methods.
<ul>
<li><strong>Selective</strong> methods are those that fine-tune only a subset of the original LLM parameters. There are several approaches that you can take to identify which parameters you want to update. You have the option to train only certain components of the model or specific layers, or even individual parameter types. Researchers have found that the performance of these methods is mixed and there are significant trade-offs between parameter efficiency and compute efficiency. We won&rsquo;t focus on them in this course.</li>
<li><strong>Reparameterization</strong> methods also work with the original LLM parameters, but reduce the number of parameters to train by creating new low rank transformations of the original network weights. A commonly used technique of this type is <strong>LoRA</strong>, which we&rsquo;ll explore in detail in the next video.</li>
<li>Lastly, <strong>Additive</strong> methods carry out fine-tuning by keeping all of the original LLM weights frozen and introducing new trainable components. Here there are two main approaches.
<ul>
<li><strong>Adapter</strong> methods add new trainable layers to the architecture of the model, typically inside the encoder or decoder components after the attention or feed-forward layers.</li>
<li><strong>Soft Prompt</strong> methods, on the other hand, keep the model architecture fixed and frozen, and focus on manipulating the input to achieve better performance. This can be done by adding trainable parameters to the prompt embeddings or keeping the input fixed and retraining the embedding weights. In this lesson, you&rsquo;ll take a look at a specific soft prompts technique called prompt tuning</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%206.png" alt="Untitled"></p>
<p>Question:</p>
<p>&ldquo;Parameter Efficient Fine-Tuning (PEFT) updates only a small subset of parameters. This helps prevent catastrophic forgetting.&rdquo; True or False?</p>
<p>True</p>
<p>Correct
Performing full-finetuning can lead to catastrophic forgetting because it changes all parameters on the model. Since PEFT only updates a small subset of parameters, it&rsquo;s more robust against this catastrophic forgetting effect.</p>
<hr>
<h2 id="peft-techniques-1-lora">PEFT Techniques 1: LoRA <a href="#peft-techniques-1-lora" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>Low-rank Adaptation, or LoRA for short, is a parameter-efficient fine-tuning technique that falls into the Reparameterization category</li>
</ul>
<h3 id="transformers-recap">Transformers Recap <a href="#transformers-recap" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>The input prompt is turned into tokens, which are then converted to embedding vectors and passed into the encoder and/or decoder parts of the transformer.</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%207.png" alt="Untitled"></p>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%208.png" alt="Untitled"></p>
<ul>
<li>In both of these components, there are two kinds of neural networks;
<ul>
<li>self-attention and</li>
<li>feedforward networks.</li>
</ul>
</li>
<li>The weights of these networks are learned during pre-training.</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%209.png" alt="Untitled"></p>
<ul>
<li>After the embedding vectors are created, they&rsquo;re fed into the self-attention layers where a series of weights are applied to calculate the attention scores</li>
<li>During full fine-tuning, every parameter in these layers is updated</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2010.png" alt="Untitled"></p>
<h3 id="lora">LoRA <a href="#lora" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>LoRA is a strategy that reduces the number of parameters to be trained during fine-tuning by freezing all of the original model parameters and then injecting a pair of rank decomposition matrices alongside the original weights.</li>
<li>The dimensions of the smaller matrices are set so that their product is a matrix with the same dimensions as the weights they&rsquo;re modifying.</li>
<li>You then keep the original weights of the LLM frozen and train the smaller matrices using the same supervised learning process you saw earlier this week.</li>
<li>For inference,
<ul>
<li>The two low-rank matrices are multiplied together to create a matrix with the same dimensions as the frozen weights.</li>
<li>You then add this to the original weights and replace them in the model with these updated values</li>
</ul>
</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2011.png" alt="Untitled"></p>
<ul>
<li>You now have a LoRA fine-tuned model that can carry out your specific task.</li>
<li>Because this model has the same number of parameters as the original, there is little to no impact on inference latency.</li>
<li>Researchers have found that applying LoRA to just the self-attention layers of the model is often enough to fine-tune for a task and achieve performance gains.</li>
<li>However, in principle, you can also use LoRA on other components like the feed-forward layers.</li>
<li>But since most of the parameters of LLMs are in the attention layers, you get the biggest savings in trainable parameters by applying LoRA to these weights matrices</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2012.png" alt="Untitled"></p>
<h3 id="lora-example">LoRA Example <a href="#lora-example" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Let&rsquo;s look at a practical example using the transformer architecture described in the Attention is All You Need paper.</li>
<li>The paper specifies that the transformer weights have dimensions of 512 by 64, this means that each weights matrix has 32,768 trainable parameters.</li>
<li>If you use LoRA as a fine-tuning method with the rank equal to eight (r=8), you will instead train two small rank decomposition matrices whose small dimension is eight.
<ul>
<li>This means that Matrix A will have dimensions of 8 by 64, resulting in 512 total parameters.
<ul>
<li>A has dimensions r x k = 8 x 64 = 512 parameters</li>
</ul>
</li>
<li>Matrix B will have dimensions of 512 by 8, or 4,096 trainable parameters.
<ul>
<li>B has dimensions d x r = 512 x 8 = 4096 parameters</li>
</ul>
</li>
</ul>
</li>
<li>By updating the weights of these new low-rank matrices instead of the original weights, you&rsquo;ll be training 4,608 parameters instead of 32,768 and 86% reduction</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2013.png" alt="Untitled"></p>
<ul>
<li>Because LoRA allows you to significantly reduce the number of trainable parameters, you can often perform this method of parameter efficient fine tuning with a single GPU and avoid the need for a distributed cluster of GPUs</li>
</ul>
<h3 id="train-on-different-tasks">Train on Different Tasks <a href="#train-on-different-tasks" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Since the rank-decomposition matrices are small, you can
<ol>
<li>fine-tune a different set for each task and then</li>
<li>switch them out at inference time by updating the weights.</li>
</ol>
</li>
<li>Suppose you train a pair of LoRA matrices for a specific task; let&rsquo;s call it Task A.
<ul>
<li>To carry out inference on this task, you would multiply these matrices together and then add the resulting matrix to the original frozen weights.</li>
<li>You then take this new summed weights matrix and replace the original weights where they appear in your model.</li>
<li>You can then use this model to carry out inference on Task A.</li>
</ul>
</li>
<li>If instead, you want to carry out a different task, say Task B, you simply take the LoRA matrices you trained for this task, calculate their product, and then add this matrix to the original weights and update the model again.</li>
<li>The memory required to store these LoRA matrices is very small.</li>
<li>So in principle, you can use LoRA to train for many tasks.</li>
<li>Switch out the weights when you need to use them, and avoid having to store multiple full-size versions of the LLM</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2014.png" alt="Untitled"></p>
<h3 id="performance-of-lora">Performance of LoRA <a href="#performance-of-lora" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Let&rsquo;s use the ROUGE metric you learned about earlier this week to compare the performance of a LoRA fine-tune model to both an original base model and a full fine-tuned version</li>
<li>Let&rsquo;s focus on fine-tuning the FLAN-T5 for dialogue summarization, which you explored earlier in the week.</li>
<li>Just to remind you, the FLAN-T5-base model has had an initial set of full fine-tuning carried out using a large instruction data set.</li>
<li>First, let&rsquo;s set a baseline score for the FLAN-T5 base model and the summarization data set we discussed earlier.
<ul>
<li>Here are the ROUGE scores for the base model where a higher number indicates better performance.</li>
<li>You should focus on the ROUGE 1 score for this discussion, but you could use any of these scores for comparison.</li>
<li>As you can see, the scores are fairly low.</li>
</ul>
</li>
<li>Next, look at the scores for a model that has had additional full fine-tuning on dialogue summarization.</li>
<li>Remember, although FLAN-T5 is a capable model, it can still benefit from additional fine-tuning on specific tasks</li>
<li>With full fine-tuning, you update every way in the model during supervised learning.
<ul>
<li>You can see that this results in a much higher ROUGE 1 score increasing over the base FLAN-T5 model by 0.19.</li>
<li>The additional round of fine-tuning has greatly improved the performance of the model on the summarization task</li>
</ul>
</li>
<li>Now let&rsquo;s take a look at the scores for the LoRA fine-tune model.
<ul>
<li>You can see that this process also resulted in a big boost in performance.</li>
<li>The ROUGE 1 score has increased from the baseline by 0.17.</li>
<li>This is a little lower than full fine-tuning, but not much.</li>
<li>However, using LoRA for fine-tuning trained a much smaller number of parameters than full fine-tuning using significantly less compute, so this small trade-off in performance may well be worth it</li>
</ul>
</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2015.png" alt="Untitled"></p>
<h3 id="choosing-the-lora-rank">Choosing the LoRA Rank <a href="#choosing-the-lora-rank" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Still an active area of research.</li>
<li>In principle, the smaller the rank, the smaller the number of trainable parameters, and the bigger the savings on compute.</li>
<li>In the paper that first proposed LoRA, researchers at Microsoft explored how different choices of rank impacted the model performance on language generation tasks.</li>
<li>The table shows the rank of the LoRA matrices in the first column, the final loss value of the model, and the scores for different metrics, including BLEU and ROUGE.
<ul>
<li>The bold values indicate the best scores that were achieved for each metric.</li>
<li>The authors found a plateau in the loss value for ranks greater than 16. In other words, using larger LoRA matrices didn&rsquo;t improve performance.</li>
</ul>
</li>
<li>The takeaway here is that ranks in the range of 4-32 can provide you with a good trade-off between reducing trainable parameters and preserving performance.</li>
<li>Optimizing the choice of rank is an ongoing area of research and best practices may evolve as more practitioners like you make use of LoRA.</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2016.png" alt="Untitled"></p>
<ul>
<li>
<p>LoRA is a powerful fine-tuning method that achieves great performance.</p>
</li>
<li>
<p>The principles behind the method are useful not just for training LLMs, but for models in other domains.</p>
</li>
<li>
<p>The final path method that you&rsquo;ll explore this week doesn&rsquo;t change the LLM at all and instead focuses on training your input text.</p>
</li>
</ul>
<hr>
<h2 id="peft-techniques-2-soft-prompts">PEFT Techniques 2: Soft Prompts <a href="#peft-techniques-2-soft-prompts" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>With LoRA, the goal was to find an efficient way to update the weights of the model without having to train every single parameter again. There are also additive methods within PEFT that aim to improve model performance without changing the weights at all</li>
<li>A second parameter efficient fine-tuning method called Prompt Tuning</li>
</ul>
<h3 id="prompt-tuning-is-not-prompt-engineering">Prompt Tuning is Not Prompt Engineering <a href="#prompt-tuning-is-not-prompt-engineering" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>With prompt engineering, you work on the language of your prompt to get the completion you want.</li>
<li>This could be as simple as trying different words or phrases or more complex, like including examples for one or few-shot Inference.</li>
<li>The goal is to help the model understand the nature of the task you&rsquo;re asking it to carry out and to generate a better completion.</li>
<li>However, there are some limitations to prompt engineering, as it can require a lot of manual effort to write and try different prompts.</li>
<li>You&rsquo;re also limited by the length of the context window, and at the end of the day, you may still not achieve the performance you need for your task</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2017.png" alt="Untitled"></p>
<h3 id="prompt-tuning">Prompt Tuning <a href="#prompt-tuning" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>With prompt tuning, you add additional trainable tokens to your prompt and leave it up to the supervised learning process to determine their optimal values.</li>
<li>The set of trainable tokens is called a soft prompt, and it gets prepended to embedding vectors that represent your input text.</li>
<li>The soft prompt vectors have the same length as the embedding vectors of the language tokens.</li>
<li>And including somewhere between 20 and 100 virtual tokens can be sufficient for good performance</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2018.png" alt="Untitled"></p>
<h3 id="soft-prompts">Soft Prompts <a href="#soft-prompts" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>The tokens that represent natural language are hard in the sense that they each correspond to a fixed location in the embedding vector space.</li>
<li>However, the soft prompts are not fixed discrete words of natural language</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2019.png" alt="Untitled"></p>
<ul>
<li>Instead, you can think of them as virtual tokens that can take on any value within the continuous multidimensional embedding space.</li>
<li>And through supervised learning, the model learns the values for these virtual tokens that maximize performance for a given task</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2020.png" alt="Untitled"></p>
<h3 id="full-fine-tuning-vs-prompt-tuning">Full Fine-tuning vs Prompt Tuning <a href="#full-fine-tuning-vs-prompt-tuning" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>In Full Fine-tuning, the training data set consists of input prompts and output completions or labels.
<ul>
<li>The weights of the large language model are updated during supervised learning</li>
</ul>
</li>
<li>In contrast, with Prompt Tuning, the weights of the large language model are frozen and the underlying model does not get updated.
<ul>
<li>Instead, the embedding vectors of the soft prompt gets updated over time to optimize the model&rsquo;s completion of the prompt</li>
<li>Prompt tuning is a very parameter efficient strategy because only a few parameters are being trained, in contrast with the millions to billions of parameters in full fine-tuning</li>
</ul>
</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2021.png" alt="Untitled"></p>
<h3 id="prompt-tuning-for-multiple-tasks">Prompt Tuning for Multiple Tasks <a href="#prompt-tuning-for-multiple-tasks" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Similar to what you saw with LoRA, you can train a different set of soft prompts for each task and then easily swap them out at inference time.</li>
<li>You can train a set of soft prompts for one task and a different set for another</li>
<li>To use them for inference, you prepend your input prompt with the learned tokens to switch to another task, you simply change the soft prompt.</li>
<li>Soft prompts are very small on disk, so this kind of fine tuning is extremely efficient and flexible.</li>
<li>You&rsquo;ll notice the same LLM is used for all tasks, all you have to do is switch out the soft prompts at inference time</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2022.png" alt="Untitled"></p>
<h3 id="performance-of-prompt-tuning">Performance of Prompt Tuning <a href="#performance-of-prompt-tuning" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>In the original paper exploring the method by Brian Lester and collaborators at Google, the authors compared prompt tuning to several other methods for a range of model sizes.</li>
<li>In this figure from the paper, you can see the Model size on the X axis and the SuperGLUE score on the Y axis.</li>
<li>This is the evaluation benchmark you learned about earlier this week that grades model performance on a number of different language tasks.
<ul>
<li>The red line shows the scores for models that were created through full fine tuning on a single task.</li>
<li>While the orange line shows the score for models created using multitask fine tuning.</li>
<li>The green line shows the performance of prompt tuning and finally, the blue line shows scores for prompt engineering only.</li>
</ul>
</li>
<li>As you can see, prompt tuning doesn&rsquo;t perform as well as full fine tuning for smaller LLMs.</li>
<li>However, as the model size increases, so does the performance of prompt tuning.</li>
<li>And once models have around 10 billion parameters, prompt tuning can be as effective as full fine-tuning and offers a significant boost in performance over prompt engineering alone</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2023.png" alt="Untitled"></p>
<h3 id="interpretability-of-soft-prompts">Interpretability of Soft Prompts <a href="#interpretability-of-soft-prompts" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>One potential issue to consider is the interpretability of learned virtual tokens.</li>
<li>Remember, because the soft prompt tokens can take any value within the continuous embedding vector space.</li>
<li>The trained tokens don&rsquo;t correspond to any known token, word, or phrase in the vocabulary of the LLM</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2024.png" alt="Untitled"></p>
<ul>
<li>However, an analysis of the nearest neighbor tokens to the soft prompt location shows that they form tight semantic clusters.</li>
<li>In other words, the words closest to the soft prompt tokens have similar meanings.</li>
<li>The words identified usually have some meaning related to the task, suggesting that the prompts are learning word like representations</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2025.png" alt="Untitled"></p>
<h3 id="summary-peft-methods">Summary: PEFT Methods <a href="#summary-peft-methods" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>You explored two PEFT methods in this lesson LoRA, which uses rank decomposition matrices to update the model parameters in an efficient way.</li>
<li>And Prompt Tuning, where trainable tokens are added to your prompt and the model weights are left untouched.</li>
<li>Both methods enable you to fine tune models with the potential for improved performance on your tasks while using much less compute than full fine-tuning methods</li>
<li>LoRA is broadly used in practice because of the comparable performance to full fine tuning for many tasks and data sets</li>
</ul>
<p><img class="img-fluid lazyload blur-up" src="https://raw.githubusercontent.com/iliyaML/hosting/main/generative-ai-with-llms/week-2-part-2/Untitled%2026.png" alt="Untitled"></p>
<h3 id="key-takeaways">Key Takeaways <a href="#key-takeaways" class="anchor" aria-hidden="true">#</a></h3>
<ul>
<li>Walked through how to adapt a foundation model through a process called Instruction Fine-tuning.</li>
<li>Along the way, you saw some of the prompt templates and data sets that were used to train the FLAN-T5 model.</li>
<li>You also saw how to use evaluation metrics and benchmarks such as ROUGE and HELM to measure success during model finetuning.</li>
<li>In practice instruction finetuning has proven very effective and useful across a wide range of natural language use cases and tasks.</li>
<li>With just a few hundred examples, you can fine tune a model to your specific task, which is truly amazing.</li>
<li>Next, you saw how parameter efficient fine-tuning, or PEFT, can reduce the amount of compute required to finetune a model.</li>
<li>You learned about two methods you can use for this LoRA and Prompt Tuning.</li>
<li>By the way you can also combine LoRA with the quantization techniques you learned about in week 1 to further reduce your memory footprint. This is known as QLoRA</li>
</ul>
<p>In practice, PEFT is used heavily to minimize compute and memory resources. And ultimately reducing the cost of fine-tuning, allowing you to make the most of your compute budget and speed up your development process</p>
<p>Question: Parameter Efficient Fine-Tuning (PEFT) methods specifically attempt to address some of the challenges of performing full fine-training. Which of the following options describe challenges that PEFT tries to overcome?</p>
<p><strong>Computational constraints</strong></p>
<p>Correct</p>
<p>Because most parameters are frozen, we typically only need to train 15%-20% of the original LLM weights, making the training process less expensive (less memory required)</p>
<p><strong>Storage requirements</strong></p>
<p>Correct</p>
<p>With PEFT, we can change just a small amount of parameters when fine-tuning, so during inference you can combine the original model with the new parameters, instead of duplicating the entire model for each new task you want to perform fine-tuning.</p>
<p><strong>Catastrophic forgetting</strong></p>
<p>Correct</p>
<p>With PEFT, most parameters of the LLM are unchanged, and that helps making it less prone to catastrophic forgetting.</p>
<hr>
<p><strong>Lab 2 Walkthrough</strong></p>
<ul>
<li>Try out fine-tuning using PEFT with LoRA for yourself by improving the summarization ability of the Flan-T5 model (flan-t5-base)</li>
<li>hands-on with full fine-tuning and Parameter-Efficient Fine-Tuning, also called PEFT with prompt instructions. You will tune the Flan-T5 model further with your own specific prompts for your specific summarization task</li>
<li>Lab 1, we were doing the zero-shot inference, the in-context learning. Now we are actually going to modify the weights of our language model, specific to our summarization task and specific to our dataset</li>
<li>Compare original model and instruction-fine-tuned model</li>
<li>PEFT
<ul>
<li>makes such a big difference, especially when you&rsquo;re constrained by how much compute resources that you have, you can lower the footprint both memory, disk, GPU, CPU, all of the resources can be reduced just by introducing PEFT into your fine-tuning process</li>
<li>In the lessons you learned about LoRA, you learned about the rank. Here we&rsquo;re going to choose rank of 32, which is actually relatively high. But we are just starting with that. Here it&rsquo;s the SEQ_2_SEQ_LM, this is FLAN-T5. With just a few extra lines of code here to configure our LoRA fine-tuning. Then here we see we&rsquo;re only going to train 1.4 percent of the trainable model parameters. In a lot of cases you can fine-tune very large models on a single GPU</li>
<li>called the PEFT adapters or LoRA adopters, get merged or combined with the original LLM</li>
<li>have to take the original LLM and then merge in this LoRA PEFT adapter</li>
<li>can actually set the <strong>is_trainable flag to false</strong>. By setting the is_trainable flag to false, we are telling PyTorch that we&rsquo;re not interested in training this model. All we&rsquo;re interested in doing is the forward pass just to get the summaries. This is significant because we can tell PyTorch to not load any of the update portions of these operators and to basically minimize the footprint needed to just perform the inference with this model. This is a pretty neat flag. This was actually just introduced recently into the PEFT model at the time of this lab. I wanted to show it here because this is a pattern that you want to try to find when you&rsquo;re doing your own modeling. When you know that you&rsquo;re ready to deploy the model for inference, there are usually ways that you can hint to the framework, such as PyTorch that you&rsquo;re not going to be training. This can then further reduce the resources needed to make these predictions</li>
</ul>
</li>
<li>PEFT - use much less resources during fine-tuning, than we would have if we did the full instruction. You can imagine this is only just a few thousand samples, but you can imagine at scale how this really can save you tons of compute resources and time by using PEFT by looking at the larger data set</li>
</ul>
<hr>
<p><strong>Lab 2 - Fine-tune a Generative AI Model For Dialogue Summarization</strong></p>
<ul>
<li>You will fine-tune an existing LLM from Hugging Face for enhanced dialogue summarization.</li>
<li>You will use the FLAN-T5 (flan-t5-base) model, which provides a high quality instruction-tuned model and can summarize text out of the box.</li>
<li>To improve the inferences, you will explore a full fine-tuning approach and evaluate the results with ROUGE metrics.</li>
<li>Then you will perform PEFT fine-tuning, evaluate the resulting model and see that the benefits of PEFT outweigh the slightly-lower performance metrics</li>
</ul>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="docs-navigation d-flex justify-content-between">
	
	<a href="/notes/nlp/generative-ai-with-llms/week-2-part-1/">
			<div class="card my-1">
				<div class="card-body py-2">
					&larr; Week 2 Part 1 - Fine-tuning LLMs with Instruction
				</div>
			</div>
		</a>
	<a class="ms-auto" href="/notes/statistics/introduction/">
			<div class="card my-1">
				<div class="card-body py-2">
					Introduction &rarr;
				</div>
			</div>
		</a>
	</div>

			
		</main>
	</div>

      </div>
    </div>
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X0X8EQ5BBE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-X0X8EQ5BBE');
</script>

<footer class="footer text-muted">
  <div class="container-xxl">
    <div class="row">
      <div class="col-lg-8 order-last order-lg-first">
        <ul class="list-inline">
          <li class="list-inline-item">Â© 2023 <a class="text-muted" href="/">iliyaML</a></li>
        </ul>
      </div>
      <div class="col-lg-8 order-first order-lg-last text-lg-end">
        <ul class="list-inline">
          </ul>
      </div>
    </div>
  </div>
</footer>
    

<script src="/js/bootstrap.min.32716f82c36f56469a1d738e1145687e0dd2c609b16c838d079ee4a441658cfa897ba465f51a85b2593709fc61b3a1481ea1d3484bf03659ad0c528e733e3df1.js" integrity="sha512-MnFvgsNvVkaaHXOOEUVofg3SxgmxbIONB57kpEFljPqJe6Rl9RqFslk3Cfxhs6FIHqHTSEvwNlmtDFKOcz498Q==" crossorigin="anonymous" defer></script>
  <script src="/js/highlight.min.51305fbad2c264cfad2dc87b1fd1537c74913dc9567a69d42535089d677099cb5be05814e68f3c8ddba219f1dc9ea53233e6f8c3d2a1dd1b7f316bea4a2ddb19.js" integrity="sha512-UTBfutLCZM&#43;tLch7H9FTfHSRPclWemnUJTUInWdwmctb4FgU5o88jduiGfHcnqUyM&#43;b4w9Kh3Rt/MWvqSi3bGQ==" crossorigin="anonymous" defer></script>
  <script src="/main.min.f7deb8c0146c4984d4c6606f3aa50cbedd9a4971789bc6b4453c74fa82166072d8d10407ae4cd8282237a5eeb299527e9dbd1ea8f479ebc839a705fcb1f3882a.js" integrity="sha512-9964wBRsSYTUxmBvOqUMvt2aSXF4m8a0RTx0&#43;oIWYHLY0QQHrkzYKCI3pe6ymVJ&#43;nb0eqPR568g5pwX8sfOIKg==" crossorigin="anonymous" defer></script>
  <script src="/index.min.7db3cffa0a2800259ac786ff927ac8987f7acae83daa4d16260810a2a48a46abf630f65d02c7b2965c716a32a63df5434a58cbdb4a05b7ef23854f4f813eb88e.js" integrity="sha512-fbPP&#43;gooACWax4b/knrImH96yug9qk0WJggQoqSKRqv2MPZdAseyllxxajKmPfVDSljL20oFt&#43;8jhU9PgT64jg==" crossorigin="anonymous" defer></script>
  
    
  </body>
</html>